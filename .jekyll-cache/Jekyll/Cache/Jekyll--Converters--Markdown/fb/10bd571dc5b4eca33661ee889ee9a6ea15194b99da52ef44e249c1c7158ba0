I"1;<p>So i build websites and apps regularly, and i use build tools all the time. Once i started using <a href="https://gruntjs.com/">grunt</a> a long time ago i fell in love. But every project you had the hassle of setting up all the tasks you want. And the basics is just building javascript (using babel), uglyfying on production it and do the same on the css side of things. So much work, every time. Now comes <a href="https://symfony.com/doc/current/frontend.html">webpack encore</a>.</p>

<p>Webpack became the thing that does is all. All in one config, well one for dev and one for production. And now we have two main files that do somewhat the same thing. Add <a href="http://sass-lang.com/">scss</a> support, and import fonts. Loaders, modules, and more and i hadn’t figured out what to do other than hope my build script works. If it won’t, just have to search and find the minute change that does the trick. Easy to say i sticked wilt <a href="https://gulpjs.com/">gulp</a>, i knew how to do one task at a time.</p>

<h2 id="symfony">Symfony?</h2>
<p>Webpack encore is built for <a href="https://symfony.com/">symfony</a>, but <strong>by no means are we gonna use that this time</strong>. So every reference to symfony is because the webpack encore docs are <a href="https://symfony.com/doc/current/frontend.html">there</a>. But in this example we are just gonna setup a basic <strong>html/css/javascript</strong> setup. I myself use the package now for a jekyll setup, standalone vue builds, clean html builds and, yes, some symfony projects.</p>

<h2 id="now-for-webpack-encore">Now for webpack encore.</h2>
<p>Let’s go for broke, create a new folder and <code class="highlighter-rouge">npm init</code>. Hit ok on everything and install webpack encore.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">npm install @symfony/webpack-encore</span>
</code></pre></div></div>

<p>Next, setup the complete and wholesome webpack.config.js file.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">Encore</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">@symfony/webpack-encore</span><span class="dl">'</span><span class="p">);</span>

<span class="nx">Encore</span>
  <span class="p">.</span><span class="nx">setOutputPath</span><span class="p">(</span><span class="dl">'</span><span class="s1">web/build/</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">setPublicPath</span><span class="p">(</span><span class="dl">'</span><span class="s1">/build</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">addEntry</span><span class="p">(</span><span class="dl">'</span><span class="s1">app</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">./assets/js/app.js</span><span class="dl">'</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">enableSassLoader</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">autoProvidejQuery</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">enableSourceMaps</span><span class="p">(</span><span class="o">!</span><span class="nx">Encore</span><span class="p">.</span><span class="nx">isProduction</span><span class="p">())</span>
  <span class="p">.</span><span class="nx">cleanupOutputBeforeBuild</span><span class="p">()</span>
<span class="p">;</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">Encore</span><span class="p">.</span><span class="nx">getWebpackConfig</span><span class="p">();</span>
</code></pre></div></div>

<p>The simple way to put this is, it builds the entire webpack.config.js for you.</p>

<p>Harder way is, it <strong>sets the output path</strong> of the files to a folder, we create, named <strong>web/build</strong>. The <strong>public path</strong> to use in javascript/css is /build. We <strong>add an entry</strong> named app, this uses the file we use as main javascript file. Like webpack uses. We are gonna <strong>enable the sass loader</strong>, i like sass. And just for kicks we <strong>auto provide jQuery</strong>. We <strong>enable source maps</strong> when we run not in production. And we <strong>clean the output before build</strong>, so the web/build folder gets emptied before scripts run.</p>

<p>One extra thing, sass is not out of the box. Nobody don’t know if you use sass, less or just plain css so we need the pre-precessors for sass.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">npm install sass-loader node-sass</span>
</code></pre></div></div>

<h2 id="files">Files</h2>
<p>So in the build we use a couple of files, lets list them.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">assets/js/app.js</span>
<span class="s">assets/css/app.scss</span>
<span class="s">web/index.html</span>
</code></pre></div></div>

<p>The index file I added in the <strong>web</strong> folder because i think the dev server uses the web folder as <strong>base folder</strong>, like this symfony thing we wont mention. Lets just go along and set the up the files.</p>

<h2 id="appjs">app.js</h2>
<p>All the javascript gets set up in here.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="dl">'</span><span class="s1">./../css/app.scss</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="appscss">app.scss</h2>
<p>The css we use in the file</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">body</span> <span class="p">{</span>
  <span class="nl">background</span><span class="p">:</span> <span class="no">pink</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="indexhtml">index.html</h2>

<p>Basic html template, to see something when we check the page.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"X-UA-Compatible"</span> <span class="na">content=</span><span class="s">"ie=edge"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"build/app.css"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Encore<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"build/app.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<h2 id="setup-scripts">Setup scripts</h2>
<p>Next up is setting up the scripts in the package.json file. These are here so we can easily access all the commands we need.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">"scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="nl">"dev"</span><span class="p">:</span><span class="w"> </span><span class="s2">"encore dev --watch"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"dev-server"</span><span class="p">:</span><span class="w"> </span><span class="s2">"encore dev-server --host 0.0.0.0 --disable-host-check --port 8080"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"production"</span><span class="p">:</span><span class="w"> </span><span class="s2">"encore production"</span><span class="w">
</span><span class="p">}</span><span class="err">,</span><span class="w">
</span></code></pre></div></div>

<h2 id="run-the-scripts">Run the scripts</h2>

<p>Next up we just run the dev script, and it generates three files in the <code class="highlighter-rouge">web/build</code> folder. An app.js (the name app comes from the entry key), app.css and manifest.json. The last we won’t use for now.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">npm run dev</span>
</code></pre></div></div>

<h2 id="dev-server">Dev server</h2>
<p>And if we want to develop and build the site we setup the dev server. Great for development.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">npm run dev-server</span>
</code></pre></div></div>
<p>And when we go to <a href="http://0.0.0.0:8080">http://0.0.0.0:8080</a> as setup in the scripts in the package.json <strong>we see a nice pink page</strong>.</p>

<h2 id="production-build">Production build</h2>
<p>Next up, run for production, it will minify all the files and we are ready for production. If you want, you can just add the postcss and autoprefixer plugin for support, you can check that here.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">npm run production</span>
</code></pre></div></div>

<h2 id="create-a-basic-page">Create a basic page</h2>
<p>Lets make things somewhat fancy, add some bootstrap and create a simple page you can see on the internet.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">npm i popper.js bootstrap@4.0.0-beta.2 font-awesome</span>
</code></pre></div></div>

<h2 id="appjs-1">app.js</h2>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./../css/app.scss</span><span class="dl">'</span><span class="p">);</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">jquery</span><span class="dl">'</span><span class="p">);</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">Popper</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">popper.js</span><span class="dl">'</span><span class="p">);</span>
<span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">bootstrap</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="appscss-1">app.scss</h2>
<div class="language-scss highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$fa-font-path</span><span class="p">:</span> <span class="s1">'~font-awesome/fonts'</span><span class="p">;</span>

<span class="k">@import</span> <span class="s2">"~bootstrap/scss/bootstrap"</span><span class="p">;</span>
<span class="k">@import</span> <span class="s2">"~font-awesome/scss/font-awesome.scss"</span><span class="p">;</span>
</code></pre></div></div>

<h2 id="indexhtml-1">index.html</h2>
<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!doctype html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"X-UA-Compatible"</span> <span class="na">content=</span><span class="s">"ie=edge"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">href=</span><span class="s">"build/app.css"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Encore<span class="nt">&lt;/title&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;br&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"jumbotron"</span><span class="nt">&gt;</span>
        ...
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"build/app.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<h2 id="small-issues">Small issues</h2>
<p>I have to say i ran in to one issue, i didn’t get the fonts to load on my dev-server. But when i deployed it did. I did deploy to github pages so i did change my font path after run for production.</p>

<h2 id="next-your-turn">Next, your turn!</h2>
<p>I did just added the files to a basic html file, that’s cool but we use frameworks and cool stuff to build our websites now. No problem. This is just the setup for basic javascipt/css builds without the hassle. If you want to add <a href="https://symfony.com/doc/current/frontend/encore/vuejs.html">vue</a> support or build a <a href="https://symfony.com/doc/current/frontend/encore/reactjs.html">react</a> app you can just add those. Let’s see what you can do, you can surely let me know.</p>

<p>My example
I typed code when i wrote my example, i did put it on the github so you can check it out, <a href="https://github.com/disjfa/encore">here</a>. The example page can be seen <a href="https://disjfa.github.io/encore/">here</a>.</p>

:ET